## M:N 관계

- N:M 관계는 관계를 가진 양쪽 당사자 모두에서 1:M관계가 존재할 때 나타나는 모습이다.

- 예를들면, 학생과 과목의 관계. 학생 입장에서는 여러 개 과목을 수강할 수 있고, 과목 입장에서 보면 여러 학생이 이 과목을 선택할 수 있다. 어느 쪽에서 봐도 다:다 관계가 성립된다.

<img src="http://drive.google.com/uc?export=view&id=1S8XsIxnj7Hhyj4Z9Sr7VccI54E5UoAIW" width="500" height="500">

- 다음과 같이 외래키를 각 테이블에 주게 되면 PK 중복이 발생한다. 

- 비즈니스 관계 = 너와 내가 뭔가 하다.(학생이 과목을 수강합니다.)

- 학생(명사) 과목(명사) 수강(동사)  -> 학생과 과목은 실제로 관계가 있는가?? 

- 사실 학생과 과목은 관계가 없다!! 관계가 없는 것에 관계를 만들려고하니 중복이 발생하는 것

- 어떤 비즈니스(수강)가 발생했을 때 이들은 관계가 생긴다.

- 학생(마스터 테이블), 과목(마스터 테이블), 수강(관계 테이블)

- 마스터 테이블은 도메인의 크기에 변화가 굉정히 적음

<img src="http://drive.google.com/uc?export=view&id=1_nkltt_2DWOsGgbdZB50_Y3ipTlONdhJ" width="500" height="500">

- 이러한 수강 테이블에는 날짜 정보가 숨어 있음(관계 테이블에는) 

- 학생과 수강의학생ID는 1:M, 과목과 수강의 과목 ID는 1:M으로 쌍방에 1:M이 됨 -> 결국 양 쪽 1을 다 빼고 보면 M:N이 되는 것 

- 두 개의 테이블에 선천적으로 관계가 있는 경우는 일단 1:M 관계로 보고 감

- 두 개의 테이블(마스터) 관계가 없다. 그럼 볼 것도 없이 m:n 관계 -> 이러한 관계는 비즈니스가 생길 때마다 관계 테이블이 생김 

- 이러한 M:N 관계는 동사를 찾아야함 그리고 동사를 발견하게 된다면 그 이름으로 관계 테이블을 만들면 m:n 관계로 나타나게 됨 

- m:n 관계에서 중복을 허용하느냐 허용하지 않느냐 이슈가 있는데

- 수강 같은 경우 중복을 허용하면 안됨 그렇기 때문에 학생ID, 과목ID 각각을 외래키이자 기본키로 사용하므로써 중복을 막을 수 있음

- 구매 같은 경우 중복을 허용해야 하기 때문에 별도의 기본키를 가지면서 고객과 상품ID를 각각 외래키로 사용하는 것이 맞다.



- 만약 비즈니스 관계가 여러 곳 발생하여 수 많은 외래키가 발생했다면? 그런데 중복도 허용하면 안된다.
 <img src="http://drive.google.com/uc?export=view&id=1bLmqGmTuDP_7FY8MvW4aFTb_u1GpcxCM" width="500" height="500">
 - 이러한 겨우 후보키를 두어 이를 가지고 검색하면 편리함 



